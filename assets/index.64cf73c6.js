var e=Object.defineProperty,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=(r,t,o)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[t]=o;import{U as s,a as i,S as c,B as l,T as n}from"./antd.52f2f62f.js";import{r as p,R as m}from"./react.eb42bb38.js";import{X as d}from"./xlsx.b520b882.js";import{u}from"./react-i18next.24f82223.js";import{v as f}from"./@ant-design.14e658af.js";import{l as j}from"./lodash.3ecb5890.js";import"./@babel.023f8892.js";import"./regenerator-runtime.e0705884.js";import"./classnames.ca41f454.js";import"./rc-notification.67cf2568.js";import"./react-dom.da73fb22.js";import"./object-assign.9840bf7d.js";import"./scheduler.1d5d78f6.js";import"./rc-motion.5487a61d.js";import"./rc-util.52d3e9c9.js";import"./react-is.d3744c61.js";import"./rc-field-form.1adb4d26.js";import"./async-validator.1fa0d626.js";import"./rc-table.814d0c89.js";import"./shallowequal.ea8d8004.js";import"./rc-resize-observer.87f23762.js";import"./resize-observer-polyfill.8deb1e21.js";import"./rc-pagination.d4f35aa3.js";import"./rc-select.15b8a1c8.js";import"./rc-virtual-list.46e41d99.js";import"./rc-overflow.dfd7b0e8.js";import"./rc-trigger.c489d32f.js";import"./rc-align.3efd88c2.js";import"./dom-align.f1b5d360.js";import"./rc-tree.8e47998c.js";import"./rc-checkbox.2f30fbea.js";import"./rc-dropdown.7f39101c.js";import"./rc-menu.05e663c9.js";import"./rc-upload.ed6364fa.js";import"./rc-picker.8aa67152.js";import"./rc-tooltip.3c3c8724.js";import"./rc-progress.49110833.js";import"./@ctrl.c644f002.js";const{Dragger:b}=s;var g=p.exports.memo((e=>{const{onUpload:s,extendClassName:c}=e,{t:l}=u("app"),n={beforeUpload:e=>{if(!e.type.includes("sheet"))return void i.error("只接受Excel文件");const r=new FileReader,t=!!r.readAsBinaryString;return r.onload=e=>{if(e.target&&e.target.result){const r=e.target.result,o=d.read(r,{type:t?"binary":"array"}),a=o.SheetNames[0],i=o.Sheets[a],c=d.utils.sheet_to_json(i,{header:1});s(c)}},t?r.readAsBinaryString(e):r.readAsArrayBuffer(e),!1},action:"/api/upload/uploadExcel",maxCount:1,showUploadList:!1,progress:{strokeColor:{"0%":"#108ee9","100%":"#87d068"},strokeWidth:3,format:e=>`${parseFloat(e.toFixed(2))}%`}};return m.createElement("div",{className:`excel-dragger ${c}`},m.createElement(b,((e,s)=>{for(var i in s||(s={}))t.call(s,i)&&a(e,i,s[i]);if(r)for(var i of r(s))o.call(s,i)&&a(e,i,s[i]);return e})({},n),m.createElement(f,{className:"upload-icon"}),m.createElement("p",null,l("Click or drag file to this area to upload"))))}));var x=p.exports.memo((()=>{const[e,r]=p.exports.useState([]),[t,o]=p.exports.useState(240),{t:a}=u("app"),s=p.exports.useRef(null);p.exports.useEffect((()=>{const e=j.exports.debounce((()=>{s&&s.current&&o(s.current.getBoundingClientRect().height-s.current.getBoundingClientRect().top-260)}),100);return o(s.current.getBoundingClientRect().height-s.current.getBoundingClientRect().top-260),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const f=p.exports.useMemo((()=>{let r=[],t=[];if(Array.isArray(e)&&e.length>0&&(r=e[0].map((e=>({title:e,dataIndex:e,key:e}))),e.length>1)){t=e.slice(1,e.length).map((r=>{const t={id:Math.random()};return e[0].map(((e,o)=>{t[e]=r[o]})),t}))}return{columns:r,dataSource:t}}),[e]);return m.createElement("div",{className:"excel-wrapper",ref:s},m.createElement(g,{onUpload:e=>{r(e)},extendClassName:"excel-upload"}),m.createElement("div",{className:"table-wrapper"},m.createElement(c,{className:"table-operate"},m.createElement(l,{type:"primary",onClick:()=>{if(!e.length)return void i.error(a("No Data"));const r=d.utils.aoa_to_sheet(e),t=d.utils.book_new();d.utils.book_append_sheet(t,r,"SheetJS"),d.writeFile(t,"sheetjs.xlsx")}},a("Export Excel"))),m.createElement(n,{columns:f.columns,dataSource:f.dataSource,className:"excel-table",scroll:{y:t},bordered:!0,rowKey:e=>e.id})))}));export default x;
